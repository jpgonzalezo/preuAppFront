/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { HttpClient } from '@angular/common/http';
import { Observable } from 'rxjs';
/**
 * @record
 */
export function ITdHttpInterceptorConfig() { }
if (false) {
    /** @type {?} */
    ITdHttpInterceptorConfig.prototype.interceptor;
    /** @type {?} */
    ITdHttpInterceptorConfig.prototype.paths;
}
var TdInterceptorBehaviorService = /** @class */ (function () {
    function TdInterceptorBehaviorService(_injector, _httpInterceptorMatcher, requestInterceptorConfigs) {
        var _this = this;
        this._injector = _injector;
        this._httpInterceptorMatcher = _httpInterceptorMatcher;
        this._requestInterceptors = [];
        requestInterceptorConfigs.forEach(function (config) {
            _this._requestInterceptors.push({
                interceptor: (/** @type {?} */ (_injector.get(config.interceptor))),
                paths: config.paths,
            });
        });
    }
    Object.defineProperty(TdInterceptorBehaviorService.prototype, "requestInterceptors", {
        get: /**
         * @return {?}
         */
        function () {
            return this._requestInterceptors;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TdInterceptorBehaviorService.prototype, "httpInterceptorMatcher", {
        get: /**
         * @return {?}
         */
        function () {
            return this._httpInterceptorMatcher;
        },
        enumerable: true,
        configurable: true
    });
    return TdInterceptorBehaviorService;
}());
export { TdInterceptorBehaviorService };
if (false) {
    /** @type {?} */
    TdInterceptorBehaviorService.prototype._requestInterceptors;
    /** @type {?} */
    TdInterceptorBehaviorService.prototype._injector;
    /** @type {?} */
    TdInterceptorBehaviorService.prototype._httpInterceptorMatcher;
}
var TdHttpService = /** @class */ (function (_super) {
    tslib_1.__extends(TdHttpService, _super);
    function TdHttpService(_handler, _interceptorBehavior) {
        var _this = _super.call(this, _handler) || this;
        _this._handler = _handler;
        _this._interceptorBehavior = _interceptorBehavior;
        return _this;
    }
    /**
     * @param {?} first
     * @param {?=} url
     * @param {?=} options
     * @return {?}
     */
    TdHttpService.prototype.request = /**
     * @param {?} first
     * @param {?=} url
     * @param {?=} options
     * @return {?}
     */
    function (first, url, options) {
        var _this = this;
        if (options === void 0) { options = {}; }
        /** @type {?} */
        var interceptors = this._interceptorBehavior.requestInterceptors.filter(function (mapping) {
            return _this._interceptorBehavior.httpInterceptorMatcher.matches({ url: url }, mapping);
        }).map(function (mapping) {
            return mapping.interceptor;
        });
        return this._setupRequest(first, url, options, interceptors);
    };
    /**
     * @param {?} method
     * @param {?} url
     * @param {?} options
     * @param {?} interceptors
     * @return {?}
     */
    TdHttpService.prototype._setupRequest = /**
     * @param {?} method
     * @param {?} url
     * @param {?} options
     * @param {?} interceptors
     * @return {?}
     */
    function (method, url, options, interceptors) {
        try {
            options = this._requestResolve(options, interceptors);
        }
        catch (e) {
            return new Observable(function (subscriber) {
                subscriber.error(e);
            });
        }
        return this._handleResponseResolve(_super.prototype.request.call(this, (/** @type {?} */ (method)), url, options), interceptors);
    };
    /**
     * @param {?} options
     * @param {?} interceptors
     * @return {?}
     */
    TdHttpService.prototype._requestResolve = /**
     * @param {?} options
     * @param {?} interceptors
     * @return {?}
     */
    function (options, interceptors) {
        interceptors.forEach(function (interceptor) {
            if (interceptor.handleOptions) {
                options = interceptor.handleOptions(options);
            }
        });
        return options;
    };
    /**
     * @param {?} obs
     * @param {?} interceptors
     * @return {?}
     */
    TdHttpService.prototype._handleResponseResolve = /**
     * @param {?} obs
     * @param {?} interceptors
     * @return {?}
     */
    function (obs, interceptors) {
        interceptors.reverse().forEach(function (interceptor) {
            if (interceptor.handleResponse) {
                obs = interceptor.handleResponse(obs);
            }
        });
        return obs;
    };
    return TdHttpService;
}(HttpClient));
export { TdHttpService };
if (false) {
    /** @type {?} */
    TdHttpService.prototype._handler;
    /** @type {?} */
    TdHttpService.prototype._interceptorBehavior;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaHR0cC5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGNvdmFsZW50L2h0dHAvIiwic291cmNlcyI6WyJpbnRlcmNlcHRvcnMvaHR0cC5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQ0EsT0FBTyxFQUFFLFVBQVUsRUFBbUUsTUFBTSxzQkFBc0IsQ0FBQztBQUVuSCxPQUFPLEVBQUUsVUFBVSxFQUFjLE1BQU0sTUFBTSxDQUFDOzs7O0FBUTlDLDhDQUdDOzs7SUFGQywrQ0FBdUI7O0lBQ3ZCLHlDQUFnQjs7QUFHbEI7SUFXRSxzQ0FBb0IsU0FBbUIsRUFDbkIsdUJBQWtELEVBQzFELHlCQUFxRDtRQUZqRSxpQkFTQztRQVRtQixjQUFTLEdBQVQsU0FBUyxDQUFVO1FBQ25CLDRCQUF1QixHQUF2Qix1QkFBdUIsQ0FBMkI7UUFYOUQseUJBQW9CLEdBQWdDLEVBQUUsQ0FBQztRQWE3RCx5QkFBeUIsQ0FBQyxPQUFPLENBQUMsVUFBQyxNQUFnQztZQUNqRSxLQUFJLENBQUMsb0JBQW9CLENBQUMsSUFBSSxDQUFDO2dCQUM3QixXQUFXLEVBQUUsbUJBQW9CLFNBQVMsQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxFQUFBO2dCQUNsRSxLQUFLLEVBQUUsTUFBTSxDQUFDLEtBQUs7YUFDcEIsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBakJELHNCQUFJLDZEQUFtQjs7OztRQUF2QjtZQUNFLE9BQU8sSUFBSSxDQUFDLG9CQUFvQixDQUFDO1FBQ25DLENBQUM7OztPQUFBO0lBRUQsc0JBQUksZ0VBQXNCOzs7O1FBQTFCO1lBQ0UsT0FBTyxJQUFJLENBQUMsdUJBQXVCLENBQUM7UUFDdEMsQ0FBQzs7O09BQUE7SUFZSCxtQ0FBQztBQUFELENBQUMsQUFyQkQsSUFxQkM7Ozs7SUFwQkMsNERBQStEOztJQVVuRCxpREFBMkI7O0lBQzNCLCtEQUEwRDs7QUFXeEU7SUFBbUMseUNBQVU7SUFFM0MsdUJBQW9CLFFBQXFCLEVBQ3JCLG9CQUFrRDtRQUR0RSxZQUVFLGtCQUFNLFFBQVEsQ0FBQyxTQUNoQjtRQUhtQixjQUFRLEdBQVIsUUFBUSxDQUFhO1FBQ3JCLDBCQUFvQixHQUFwQixvQkFBb0IsQ0FBOEI7O0lBRXRFLENBQUM7Ozs7Ozs7SUFFRCwrQkFBTzs7Ozs7O0lBQVAsVUFBUSxLQUE4QixFQUFFLEdBQVksRUFBRSxPQVFoRDtRQVJOLGlCQWVDO1FBZnFELHdCQUFBLEVBQUEsWUFRaEQ7O1lBQ0EsWUFBWSxHQUF5QixJQUFJLENBQUMsb0JBQW9CLENBQUMsbUJBQW1CLENBQUMsTUFBTSxDQUFDLFVBQUMsT0FBa0M7WUFDL0gsT0FBTyxLQUFJLENBQUMsb0JBQW9CLENBQUMsc0JBQXNCLENBQUMsT0FBTyxDQUFDLEVBQUMsR0FBRyxFQUFFLEdBQUcsRUFBQyxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQ3ZGLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxVQUFDLE9BQWtDO1lBQ3hDLE9BQU8sT0FBTyxDQUFDLFdBQVcsQ0FBQztRQUM3QixDQUFDLENBQUM7UUFDRixPQUFPLElBQUksQ0FBQyxhQUFhLENBQUMsS0FBSyxFQUFFLEdBQUcsRUFBRSxPQUFPLEVBQUUsWUFBWSxDQUFDLENBQUM7SUFDL0QsQ0FBQzs7Ozs7Ozs7SUFFTyxxQ0FBYTs7Ozs7OztJQUFyQixVQUFzQixNQUErQixFQUMvQixHQUFXLEVBQ1gsT0FBbUMsRUFDbkMsWUFBa0M7UUFDdEQsSUFBSTtZQUNGLE9BQU8sR0FBRyxJQUFJLENBQUMsZUFBZSxDQUFDLE9BQU8sRUFBRSxZQUFZLENBQUMsQ0FBQztTQUN2RDtRQUFDLE9BQU8sQ0FBQyxFQUFFO1lBQ1YsT0FBTyxJQUFJLFVBQVUsQ0FBTSxVQUFDLFVBQTJCO2dCQUNyRCxVQUFVLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ3RCLENBQUMsQ0FBQyxDQUFDO1NBQ0o7UUFDRCxPQUFPLElBQUksQ0FBQyxzQkFBc0IsQ0FBQyxpQkFBTSxPQUFPLFlBQUMsbUJBQUssTUFBTSxFQUFBLEVBQUUsR0FBRyxFQUFFLE9BQU8sQ0FBQyxFQUFFLFlBQVksQ0FBQyxDQUFDO0lBQzdGLENBQUM7Ozs7OztJQUVPLHVDQUFlOzs7OztJQUF2QixVQUF3QixPQUFtQyxFQUFFLFlBQWtDO1FBQzdGLFlBQVksQ0FBQyxPQUFPLENBQUMsVUFBQyxXQUErQjtZQUNuRCxJQUFJLFdBQVcsQ0FBQyxhQUFhLEVBQUU7Z0JBQzdCLE9BQU8sR0FBRyxXQUFXLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxDQUFDO2FBQzlDO1FBQ0gsQ0FBQyxDQUFDLENBQUM7UUFDSCxPQUFPLE9BQU8sQ0FBQztJQUNqQixDQUFDOzs7Ozs7SUFFTyw4Q0FBc0I7Ozs7O0lBQTlCLFVBQStCLEdBQW9CLEVBQUUsWUFBa0M7UUFDckYsWUFBWSxDQUFDLE9BQU8sRUFBRSxDQUFDLE9BQU8sQ0FBQyxVQUFDLFdBQStCO1lBQzdELElBQUksV0FBVyxDQUFDLGNBQWMsRUFBRTtnQkFDOUIsR0FBRyxHQUFHLFdBQVcsQ0FBQyxjQUFjLENBQUMsR0FBRyxDQUFDLENBQUM7YUFDdkM7UUFDSCxDQUFDLENBQUMsQ0FBQztRQUNILE9BQU8sR0FBRyxDQUFDO0lBQ2IsQ0FBQztJQUNILG9CQUFDO0FBQUQsQ0FBQyxBQXZERCxDQUFtQyxVQUFVLEdBdUQ1Qzs7OztJQXJEYSxpQ0FBNkI7O0lBQzdCLDZDQUEwRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFR5cGUsIEluamVjdG9yIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBIdHRwQ2xpZW50LCBIdHRwSGFuZGxlciwgSHR0cFJlc3BvbnNlLCBIdHRwUmVxdWVzdCwgSHR0cEhlYWRlcnMsIEh0dHBQYXJhbXMgfSBmcm9tICdAYW5ndWxhci9jb21tb24vaHR0cCc7XG5cbmltcG9ydCB7IE9ic2VydmFibGUsIFN1YnNjcmliZXIgfSBmcm9tICdyeGpzJztcblxuaW1wb3J0IHsgSVRkSHR0cEludGVyY2VwdG9yIH0gZnJvbSAnLi9odHRwLWludGVyY2VwdG9yLmludGVyZmFjZSc7XG5pbXBvcnQgeyBJVGRIdHRwSW50ZXJjZXB0b3JNYXRjaGVyIH0gZnJvbSAnLi9odHRwLWludGVyY2VwdG9yLW1hdGNoZXIuaW50ZXJmYWNlJztcbmltcG9ydCB7IElUZEh0dHBJbnRlcmNlcHRvck1hcHBpbmcgfSBmcm9tICcuL2h0dHAtaW50ZXJjZXB0b3ItbWFwcGluZy5pbnRlcmZhY2UnO1xuXG5pbXBvcnQgeyBJVGRIdHRwUkVTVE9wdGlvbnNXaXRoQm9keSB9IGZyb20gJy4uL2h0dHAuaW50ZXJmYWNlcyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSVRkSHR0cEludGVyY2VwdG9yQ29uZmlnIHtcbiAgaW50ZXJjZXB0b3I6IFR5cGU8YW55PjtcbiAgcGF0aHM6IHN0cmluZ1tdO1xufVxuXG5leHBvcnQgY2xhc3MgVGRJbnRlcmNlcHRvckJlaGF2aW9yU2VydmljZSB7XG4gIHByaXZhdGUgX3JlcXVlc3RJbnRlcmNlcHRvcnM6IElUZEh0dHBJbnRlcmNlcHRvck1hcHBpbmdbXSA9IFtdO1xuXG4gIGdldCByZXF1ZXN0SW50ZXJjZXB0b3JzKCk6IElUZEh0dHBJbnRlcmNlcHRvck1hcHBpbmdbXSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3RJbnRlcmNlcHRvcnM7XG4gIH1cblxuICBnZXQgaHR0cEludGVyY2VwdG9yTWF0Y2hlcigpOiBJVGRIdHRwSW50ZXJjZXB0b3JNYXRjaGVyIHtcbiAgICByZXR1cm4gdGhpcy5faHR0cEludGVyY2VwdG9yTWF0Y2hlcjtcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgX2luamVjdG9yOiBJbmplY3RvcixcbiAgICAgICAgICAgICAgcHJpdmF0ZSBfaHR0cEludGVyY2VwdG9yTWF0Y2hlcjogSVRkSHR0cEludGVyY2VwdG9yTWF0Y2hlcixcbiAgICAgICAgICAgICAgcmVxdWVzdEludGVyY2VwdG9yQ29uZmlnczogSVRkSHR0cEludGVyY2VwdG9yQ29uZmlnW10pIHtcbiAgICByZXF1ZXN0SW50ZXJjZXB0b3JDb25maWdzLmZvckVhY2goKGNvbmZpZzogSVRkSHR0cEludGVyY2VwdG9yQ29uZmlnKSA9PiB7XG4gICAgICB0aGlzLl9yZXF1ZXN0SW50ZXJjZXB0b3JzLnB1c2goe1xuICAgICAgICBpbnRlcmNlcHRvcjogPElUZEh0dHBJbnRlcmNlcHRvcj5faW5qZWN0b3IuZ2V0KGNvbmZpZy5pbnRlcmNlcHRvciksXG4gICAgICAgIHBhdGhzOiBjb25maWcucGF0aHMsXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgVGRIdHRwU2VydmljZSBleHRlbmRzIEh0dHBDbGllbnQge1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgX2hhbmRsZXI6IEh0dHBIYW5kbGVyLFxuICAgICAgICAgICAgICBwcml2YXRlIF9pbnRlcmNlcHRvckJlaGF2aW9yOiBUZEludGVyY2VwdG9yQmVoYXZpb3JTZXJ2aWNlKSB7XG4gICAgc3VwZXIoX2hhbmRsZXIpO1xuICB9XG5cbiAgcmVxdWVzdChmaXJzdDogc3RyaW5nfEh0dHBSZXF1ZXN0PGFueT4sIHVybD86IHN0cmluZywgb3B0aW9uczoge1xuICAgIGJvZHk/OiBhbnksXG4gICAgaGVhZGVycz86IEh0dHBIZWFkZXJzfHtbaGVhZGVyOiBzdHJpbmddOiBzdHJpbmcgfCBzdHJpbmdbXX0sXG4gICAgb2JzZXJ2ZT86ICdib2R5JyB8ICdldmVudHMnIHwgJ3Jlc3BvbnNlJyxcbiAgICBwYXJhbXM/OiBIdHRwUGFyYW1zfHtbcGFyYW06IHN0cmluZ106IHN0cmluZyB8IHN0cmluZ1tdfSxcbiAgICByZXBvcnRQcm9ncmVzcz86IGJvb2xlYW4sXG4gICAgcmVzcG9uc2VUeXBlPzogJ2FycmF5YnVmZmVyJ3wnYmxvYid8J2pzb24nfCd0ZXh0JyxcbiAgICB3aXRoQ3JlZGVudGlhbHM/OiBib29sZWFuLFxuICB9ID0ge30pOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgIGxldCBpbnRlcmNlcHRvcnM6IElUZEh0dHBJbnRlcmNlcHRvcltdID0gdGhpcy5faW50ZXJjZXB0b3JCZWhhdmlvci5yZXF1ZXN0SW50ZXJjZXB0b3JzLmZpbHRlcigobWFwcGluZzogSVRkSHR0cEludGVyY2VwdG9yTWFwcGluZykgPT4ge1xuICAgICAgcmV0dXJuIHRoaXMuX2ludGVyY2VwdG9yQmVoYXZpb3IuaHR0cEludGVyY2VwdG9yTWF0Y2hlci5tYXRjaGVzKHt1cmw6IHVybH0sIG1hcHBpbmcpO1xuICAgIH0pLm1hcCgobWFwcGluZzogSVRkSHR0cEludGVyY2VwdG9yTWFwcGluZykgPT4ge1xuICAgICAgcmV0dXJuIG1hcHBpbmcuaW50ZXJjZXB0b3I7XG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXMuX3NldHVwUmVxdWVzdChmaXJzdCwgdXJsLCBvcHRpb25zLCBpbnRlcmNlcHRvcnMpO1xuICB9XG5cbiAgcHJpdmF0ZSBfc2V0dXBSZXF1ZXN0KG1ldGhvZDogc3RyaW5nfEh0dHBSZXF1ZXN0PGFueT4sXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6IHN0cmluZyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IElUZEh0dHBSRVNUT3B0aW9uc1dpdGhCb2R5LFxuICAgICAgICAgICAgICAgICAgICAgICAgaW50ZXJjZXB0b3JzOiBJVGRIdHRwSW50ZXJjZXB0b3JbXSk6IE9ic2VydmFibGU8SHR0cFJlc3BvbnNlPGFueT4+IHtcbiAgICB0cnkge1xuICAgICAgb3B0aW9ucyA9IHRoaXMuX3JlcXVlc3RSZXNvbHZlKG9wdGlvbnMsIGludGVyY2VwdG9ycyk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgcmV0dXJuIG5ldyBPYnNlcnZhYmxlPGFueT4oKHN1YnNjcmliZXI6IFN1YnNjcmliZXI8YW55PikgPT4ge1xuICAgICAgICBzdWJzY3JpYmVyLmVycm9yKGUpO1xuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLl9oYW5kbGVSZXNwb25zZVJlc29sdmUoc3VwZXIucmVxdWVzdCg8YW55Pm1ldGhvZCwgdXJsLCBvcHRpb25zKSwgaW50ZXJjZXB0b3JzKTtcbiAgfVxuXG4gIHByaXZhdGUgX3JlcXVlc3RSZXNvbHZlKG9wdGlvbnM6IElUZEh0dHBSRVNUT3B0aW9uc1dpdGhCb2R5LCBpbnRlcmNlcHRvcnM6IElUZEh0dHBJbnRlcmNlcHRvcltdKTogSVRkSHR0cFJFU1RPcHRpb25zV2l0aEJvZHkge1xuICAgIGludGVyY2VwdG9ycy5mb3JFYWNoKChpbnRlcmNlcHRvcjogSVRkSHR0cEludGVyY2VwdG9yKSA9PiB7XG4gICAgICBpZiAoaW50ZXJjZXB0b3IuaGFuZGxlT3B0aW9ucykge1xuICAgICAgICBvcHRpb25zID0gaW50ZXJjZXB0b3IuaGFuZGxlT3B0aW9ucyhvcHRpb25zKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gb3B0aW9ucztcbiAgfVxuXG4gIHByaXZhdGUgX2hhbmRsZVJlc3BvbnNlUmVzb2x2ZShvYnM6IE9ic2VydmFibGU8YW55PiwgaW50ZXJjZXB0b3JzOiBJVGRIdHRwSW50ZXJjZXB0b3JbXSk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgaW50ZXJjZXB0b3JzLnJldmVyc2UoKS5mb3JFYWNoKChpbnRlcmNlcHRvcjogSVRkSHR0cEludGVyY2VwdG9yKSA9PiB7XG4gICAgICBpZiAoaW50ZXJjZXB0b3IuaGFuZGxlUmVzcG9uc2UpIHtcbiAgICAgICAgb2JzID0gaW50ZXJjZXB0b3IuaGFuZGxlUmVzcG9uc2Uob2JzKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gb2JzO1xuICB9XG59XG4iXX0=