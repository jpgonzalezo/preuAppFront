/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
import { Injectable, SkipSelf, Optional } from '@angular/core';
import { Validators, FormControl } from '@angular/forms';
import { TdDynamicInputComponent } from '../dynamic-elements/dynamic-input/dynamic-input.component';
import { TdDynamicFileInputComponent } from '../dynamic-elements/dynamic-file-input/dynamic-file-input.component';
import { TdDynamicTextareaComponent } from '../dynamic-elements/dynamic-textarea/dynamic-textarea.component';
import { TdDynamicSlideToggleComponent } from '../dynamic-elements/dynamic-slide-toggle/dynamic-slide-toggle.component';
import { TdDynamicCheckboxComponent } from '../dynamic-elements/dynamic-checkbox/dynamic-checkbox.component';
import { TdDynamicSliderComponent } from '../dynamic-elements/dynamic-slider/dynamic-slider.component';
import { TdDynamicSelectComponent } from '../dynamic-elements/dynamic-select/dynamic-select.component';
import { TdDynamicDatepickerComponent } from '../dynamic-elements/dynamic-datepicker/dynamic-datepicker.component';
/** @enum {string} */
var TdDynamicType = {
    Text: 'text',
    Boolean: 'boolean',
    Number: 'number',
    Array: 'array',
    Date: 'date',
};
export { TdDynamicType };
/** @enum {string} */
var TdDynamicElement = {
    Input: 'input',
    Datepicker: 'datepicker',
    Password: 'password',
    Textarea: 'textarea',
    Slider: 'slider',
    SlideToggle: 'slide-toggle',
    Checkbox: 'checkbox',
    Select: 'select',
    FileInput: 'file-input',
};
export { TdDynamicElement };
/**
 * @record
 */
export function ITdDynamicElementValidator() { }
if (false) {
    /** @type {?} */
    ITdDynamicElementValidator.prototype.validator;
}
/**
 * @record
 */
export function ITdDynamicElementConfig() { }
if (false) {
    /** @type {?|undefined} */
    ITdDynamicElementConfig.prototype.label;
    /** @type {?} */
    ITdDynamicElementConfig.prototype.name;
    /** @type {?|undefined} */
    ITdDynamicElementConfig.prototype.hint;
    /** @type {?} */
    ITdDynamicElementConfig.prototype.type;
    /** @type {?|undefined} */
    ITdDynamicElementConfig.prototype.required;
    /** @type {?|undefined} */
    ITdDynamicElementConfig.prototype.disabled;
    /** @type {?|undefined} */
    ITdDynamicElementConfig.prototype.min;
    /** @type {?|undefined} */
    ITdDynamicElementConfig.prototype.max;
    /** @type {?|undefined} */
    ITdDynamicElementConfig.prototype.minLength;
    /** @type {?|undefined} */
    ITdDynamicElementConfig.prototype.maxLength;
    /** @type {?|undefined} */
    ITdDynamicElementConfig.prototype.selections;
    /** @type {?|undefined} */
    ITdDynamicElementConfig.prototype.multiple;
    /** @type {?|undefined} */
    ITdDynamicElementConfig.prototype.default;
    /** @type {?|undefined} */
    ITdDynamicElementConfig.prototype.flex;
    /** @type {?|undefined} */
    ITdDynamicElementConfig.prototype.validators;
}
/** @type {?} */
export var DYNAMIC_ELEMENT_NAME_REGEX = /^[^0-9][^\@]*$/;
var TdDynamicFormsService = /** @class */ (function () {
    function TdDynamicFormsService() {
    }
    /**
     * Method to validate if the [name] is a proper element name.
     * Throws error if name is not valid.
     */
    /**
     * Method to validate if the [name] is a proper element name.
     * Throws error if name is not valid.
     * @param {?} name
     * @return {?}
     */
    TdDynamicFormsService.prototype.validateDynamicElementName = /**
     * Method to validate if the [name] is a proper element name.
     * Throws error if name is not valid.
     * @param {?} name
     * @return {?}
     */
    function (name) {
        if (!DYNAMIC_ELEMENT_NAME_REGEX.test(name)) {
            throw new Error('Dynamic element name: "${name}" is not valid.');
        }
    };
    /**
     * Gets component to be rendered depending on [TdDynamicElement | TdDynamicType]
     * Throws error if it does not exists or not supported.
     */
    /**
     * Gets component to be rendered depending on [TdDynamicElement | TdDynamicType]
     * Throws error if it does not exists or not supported.
     * @param {?} element
     * @return {?}
     */
    TdDynamicFormsService.prototype.getDynamicElement = /**
     * Gets component to be rendered depending on [TdDynamicElement | TdDynamicType]
     * Throws error if it does not exists or not supported.
     * @param {?} element
     * @return {?}
     */
    function (element) {
        switch (element) {
            case TdDynamicType.Text:
            case TdDynamicType.Number:
            case TdDynamicElement.Input:
            case TdDynamicElement.Password:
                return TdDynamicInputComponent;
            case TdDynamicElement.Textarea:
                return TdDynamicTextareaComponent;
            case TdDynamicType.Boolean:
            case TdDynamicElement.SlideToggle:
                return TdDynamicSlideToggleComponent;
            case TdDynamicElement.Checkbox:
                return TdDynamicCheckboxComponent;
            case TdDynamicElement.Slider:
                return TdDynamicSliderComponent;
            case TdDynamicType.Array:
            case TdDynamicElement.Select:
                return TdDynamicSelectComponent;
            case TdDynamicElement.FileInput:
                return TdDynamicFileInputComponent;
            case TdDynamicElement.Datepicker:
            case TdDynamicType.Date:
                return TdDynamicDatepickerComponent;
            default:
                throw new Error("Error: type " + element + " does not exist or not supported.");
        }
    };
    /**
     * Creates form control for element depending [ITdDynamicElementConfig] properties.
     */
    /**
     * Creates form control for element depending [ITdDynamicElementConfig] properties.
     * @param {?} config
     * @return {?}
     */
    TdDynamicFormsService.prototype.createFormControl = /**
     * Creates form control for element depending [ITdDynamicElementConfig] properties.
     * @param {?} config
     * @return {?}
     */
    function (config) {
        /** @type {?} */
        var validator = this.createValidators(config);
        return new FormControl({ value: config.default, disabled: config.disabled }, validator);
    };
    /**
     * Creates form validationdepending [ITdDynamicElementConfig] properties.
     */
    /**
     * Creates form validationdepending [ITdDynamicElementConfig] properties.
     * @param {?} config
     * @return {?}
     */
    TdDynamicFormsService.prototype.createValidators = /**
     * Creates form validationdepending [ITdDynamicElementConfig] properties.
     * @param {?} config
     * @return {?}
     */
    function (config) {
        /** @type {?} */
        var validator;
        if (config.required) {
            validator = Validators.required;
        }
        if (config.max || config.max === 0) {
            validator = Validators.compose([validator, Validators.max(parseFloat(config.max))]);
        }
        if (config.min || config.min === 0) {
            validator = Validators.compose([validator, Validators.min(parseFloat(config.min))]);
        }
        if (config.maxLength || config.maxLength === 0) {
            validator = Validators.compose([validator, Validators.maxLength(parseFloat(config.maxLength))]);
        }
        if (config.minLength || config.minLength === 0) {
            validator = Validators.compose([validator, Validators.minLength(parseFloat(config.minLength))]);
        }
        // Add provided custom validators to the validator function
        if (config.validators) {
            config.validators.forEach(function (validatorConfig) {
                validator = Validators.compose([validator, validatorConfig.validator]);
            });
        }
        return validator;
    };
    TdDynamicFormsService.decorators = [
        { type: Injectable }
    ];
    return TdDynamicFormsService;
}());
export { TdDynamicFormsService };
/**
 * @param {?} parent
 * @return {?}
 */
export function DYNAMIC_FORMS_PROVIDER_FACTORY(parent) {
    return parent || new TdDynamicFormsService();
}
/** @type {?} */
export var DYNAMIC_FORMS_PROVIDER = {
    // If there is already a service available, use that. Otherwise, provide a new one.
    provide: TdDynamicFormsService,
    deps: [[new Optional(), new SkipSelf(), TdDynamicFormsService]],
    useFactory: DYNAMIC_FORMS_PROVIDER_FACTORY,
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZHluYW1pYy1mb3Jtcy5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGNvdmFsZW50L2R5bmFtaWMtZm9ybXMvIiwic291cmNlcyI6WyJzZXJ2aWNlcy9keW5hbWljLWZvcm1zLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQVksUUFBUSxFQUFFLFFBQVEsRUFBUSxNQUFNLGVBQWUsQ0FBQztBQUMvRSxPQUFPLEVBQUUsVUFBVSxFQUFlLFdBQVcsRUFBbUIsTUFBTSxnQkFBZ0IsQ0FBQztBQUV2RixPQUFPLEVBQUUsdUJBQXVCLEVBQUUsTUFBTSwyREFBMkQsQ0FBQztBQUNwRyxPQUFPLEVBQUUsMkJBQTJCLEVBQUUsTUFBTSxxRUFBcUUsQ0FBQztBQUNsSCxPQUFPLEVBQUUsMEJBQTBCLEVBQUUsTUFBTSxpRUFBaUUsQ0FBQztBQUM3RyxPQUFPLEVBQUUsNkJBQTZCLEVBQUUsTUFBTSx5RUFBeUUsQ0FBQztBQUN4SCxPQUFPLEVBQUUsMEJBQTBCLEVBQUUsTUFBTSxpRUFBaUUsQ0FBQztBQUM3RyxPQUFPLEVBQUUsd0JBQXdCLEVBQUUsTUFBTSw2REFBNkQsQ0FBQztBQUN2RyxPQUFPLEVBQUUsd0JBQXdCLEVBQUUsTUFBTSw2REFBNkQsQ0FBQztBQUN2RyxPQUFPLEVBQUUsNEJBQTRCLEVBQUUsTUFBTSxxRUFBcUUsQ0FBQzs7O0lBR2pILE1BQU8sTUFBTTtJQUNiLFNBQVUsU0FBUztJQUNuQixRQUFTLFFBQVE7SUFDakIsT0FBUSxPQUFPO0lBQ2YsTUFBTyxNQUFNOzs7OztJQUliLE9BQVEsT0FBTztJQUNmLFlBQWEsWUFBWTtJQUN6QixVQUFXLFVBQVU7SUFDckIsVUFBVyxVQUFVO0lBQ3JCLFFBQVMsUUFBUTtJQUNqQixhQUFjLGNBQWM7SUFDNUIsVUFBVyxVQUFVO0lBQ3JCLFFBQVMsUUFBUTtJQUNqQixXQUFZLFlBQVk7Ozs7OztBQUcxQixnREFFQzs7O0lBREMsK0NBQXVCOzs7OztBQUd6Qiw2Q0FnQkM7OztJQWZDLHdDQUFlOztJQUNmLHVDQUFhOztJQUNiLHVDQUFjOztJQUNkLHVDQUFtRDs7SUFDbkQsMkNBQW1COztJQUNuQiwyQ0FBbUI7O0lBQ25CLHNDQUFVOztJQUNWLHNDQUFVOztJQUNWLDRDQUFnQjs7SUFDaEIsNENBQWdCOztJQUNoQiw2Q0FBd0Q7O0lBQ3hELDJDQUFtQjs7SUFDbkIsMENBQWM7O0lBQ2QsdUNBQWM7O0lBQ2QsNkNBQTBDOzs7QUFHNUMsTUFBTSxLQUFPLDBCQUEwQixHQUFXLGdCQUFnQjtBQUVsRTtJQUFBO0lBa0ZBLENBQUM7SUEvRUM7OztPQUdHOzs7Ozs7O0lBQ0gsMERBQTBCOzs7Ozs7SUFBMUIsVUFBMkIsSUFBWTtRQUNyQyxJQUFJLENBQUMsMEJBQTBCLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFO1lBQzFDLE1BQU0sSUFBSSxLQUFLLENBQUMsK0NBQStDLENBQUMsQ0FBQztTQUNsRTtJQUNILENBQUM7SUFFRDs7O09BR0c7Ozs7Ozs7SUFDSCxpREFBaUI7Ozs7OztJQUFqQixVQUFrQixPQUF5QztRQUN6RCxRQUFRLE9BQU8sRUFBRTtZQUNmLEtBQUssYUFBYSxDQUFDLElBQUksQ0FBQztZQUN4QixLQUFLLGFBQWEsQ0FBQyxNQUFNLENBQUM7WUFDMUIsS0FBSyxnQkFBZ0IsQ0FBQyxLQUFLLENBQUM7WUFDNUIsS0FBSyxnQkFBZ0IsQ0FBQyxRQUFRO2dCQUM1QixPQUFPLHVCQUF1QixDQUFDO1lBQ2pDLEtBQUssZ0JBQWdCLENBQUMsUUFBUTtnQkFDNUIsT0FBTywwQkFBMEIsQ0FBQztZQUNwQyxLQUFLLGFBQWEsQ0FBQyxPQUFPLENBQUM7WUFDM0IsS0FBSyxnQkFBZ0IsQ0FBQyxXQUFXO2dCQUMvQixPQUFPLDZCQUE2QixDQUFDO1lBQ3ZDLEtBQUssZ0JBQWdCLENBQUMsUUFBUTtnQkFDNUIsT0FBTywwQkFBMEIsQ0FBQztZQUNwQyxLQUFLLGdCQUFnQixDQUFDLE1BQU07Z0JBQzFCLE9BQU8sd0JBQXdCLENBQUM7WUFDbEMsS0FBSyxhQUFhLENBQUMsS0FBSyxDQUFDO1lBQ3pCLEtBQUssZ0JBQWdCLENBQUMsTUFBTTtnQkFDMUIsT0FBTyx3QkFBd0IsQ0FBQztZQUNsQyxLQUFLLGdCQUFnQixDQUFDLFNBQVM7Z0JBQzdCLE9BQU8sMkJBQTJCLENBQUM7WUFDckMsS0FBSyxnQkFBZ0IsQ0FBQyxVQUFVLENBQUM7WUFDakMsS0FBSyxhQUFhLENBQUMsSUFBSTtnQkFDckIsT0FBTyw0QkFBNEIsQ0FBQztZQUN0QztnQkFDRSxNQUFNLElBQUksS0FBSyxDQUFDLGlCQUFlLE9BQU8sc0NBQW1DLENBQUMsQ0FBQztTQUM5RTtJQUNILENBQUM7SUFFRDs7T0FFRzs7Ozs7O0lBQ0gsaURBQWlCOzs7OztJQUFqQixVQUFrQixNQUErQjs7WUFDM0MsU0FBUyxHQUFnQixJQUFJLENBQUMsZ0JBQWdCLENBQUMsTUFBTSxDQUFDO1FBQzFELE9BQU8sSUFBSSxXQUFXLENBQUMsRUFBRSxLQUFLLEVBQUUsTUFBTSxDQUFDLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxDQUFDLFFBQVEsRUFBRSxFQUFFLFNBQVMsQ0FBQyxDQUFDO0lBQzFGLENBQUM7SUFFRDs7T0FFRzs7Ozs7O0lBQ0gsZ0RBQWdCOzs7OztJQUFoQixVQUFpQixNQUErQjs7WUFDMUMsU0FBc0I7UUFDMUIsSUFBSSxNQUFNLENBQUMsUUFBUSxFQUFFO1lBQ25CLFNBQVMsR0FBRyxVQUFVLENBQUMsUUFBUSxDQUFDO1NBQ2pDO1FBQ0QsSUFBSSxNQUFNLENBQUMsR0FBRyxJQUFJLE1BQU0sQ0FBQyxHQUFHLEtBQUssQ0FBQyxFQUFFO1lBQ2xDLFNBQVMsR0FBRyxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUMsU0FBUyxFQUFFLFVBQVUsQ0FBQyxHQUFHLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUNyRjtRQUNELElBQUksTUFBTSxDQUFDLEdBQUcsSUFBSSxNQUFNLENBQUMsR0FBRyxLQUFLLENBQUMsRUFBRTtZQUNsQyxTQUFTLEdBQUcsVUFBVSxDQUFDLE9BQU8sQ0FBQyxDQUFDLFNBQVMsRUFBRSxVQUFVLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDckY7UUFDRCxJQUFJLE1BQU0sQ0FBQyxTQUFTLElBQUksTUFBTSxDQUFDLFNBQVMsS0FBSyxDQUFDLEVBQUU7WUFDOUMsU0FBUyxHQUFHLFVBQVUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxTQUFTLEVBQUUsVUFBVSxDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQ2pHO1FBQ0QsSUFBSSxNQUFNLENBQUMsU0FBUyxJQUFJLE1BQU0sQ0FBQyxTQUFTLEtBQUssQ0FBQyxFQUFFO1lBQzlDLFNBQVMsR0FBRyxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUMsU0FBUyxFQUFFLFVBQVUsQ0FBQyxTQUFTLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUNqRztRQUNELDJEQUEyRDtRQUMzRCxJQUFJLE1BQU0sQ0FBQyxVQUFVLEVBQUU7WUFDckIsTUFBTSxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMsVUFBQyxlQUEyQztnQkFDcEUsU0FBUyxHQUFHLFVBQVUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxTQUFTLEVBQUUsZUFBZSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUM7WUFDekUsQ0FBQyxDQUFDLENBQUM7U0FDSjtRQUNELE9BQU8sU0FBUyxDQUFDO0lBQ25CLENBQUM7O2dCQWpGRixVQUFVOztJQWtGWCw0QkFBQztDQUFBLEFBbEZELElBa0ZDO1NBakZZLHFCQUFxQjs7Ozs7QUFtRmxDLE1BQU0sVUFBVSw4QkFBOEIsQ0FDNUMsTUFBNkI7SUFDN0IsT0FBTyxNQUFNLElBQUksSUFBSSxxQkFBcUIsRUFBRSxDQUFDO0FBQy9DLENBQUM7O0FBRUQsTUFBTSxLQUFPLHNCQUFzQixHQUFhOztJQUU5QyxPQUFPLEVBQUUscUJBQXFCO0lBQzlCLElBQUksRUFBRSxDQUFDLENBQUMsSUFBSSxRQUFRLEVBQUUsRUFBRSxJQUFJLFFBQVEsRUFBRSxFQUFFLHFCQUFxQixDQUFDLENBQUM7SUFDL0QsVUFBVSxFQUFFLDhCQUE4QjtDQUMzQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUsIFByb3ZpZGVyLCBTa2lwU2VsZiwgT3B0aW9uYWwsIFR5cGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFZhbGlkYXRvcnMsIFZhbGlkYXRvckZuLCBGb3JtQ29udHJvbCwgQWJzdHJhY3RDb250cm9sIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xuXG5pbXBvcnQgeyBUZER5bmFtaWNJbnB1dENvbXBvbmVudCB9IGZyb20gJy4uL2R5bmFtaWMtZWxlbWVudHMvZHluYW1pYy1pbnB1dC9keW5hbWljLWlucHV0LmNvbXBvbmVudCc7XG5pbXBvcnQgeyBUZER5bmFtaWNGaWxlSW5wdXRDb21wb25lbnQgfSBmcm9tICcuLi9keW5hbWljLWVsZW1lbnRzL2R5bmFtaWMtZmlsZS1pbnB1dC9keW5hbWljLWZpbGUtaW5wdXQuY29tcG9uZW50JztcbmltcG9ydCB7IFRkRHluYW1pY1RleHRhcmVhQ29tcG9uZW50IH0gZnJvbSAnLi4vZHluYW1pYy1lbGVtZW50cy9keW5hbWljLXRleHRhcmVhL2R5bmFtaWMtdGV4dGFyZWEuY29tcG9uZW50JztcbmltcG9ydCB7IFRkRHluYW1pY1NsaWRlVG9nZ2xlQ29tcG9uZW50IH0gZnJvbSAnLi4vZHluYW1pYy1lbGVtZW50cy9keW5hbWljLXNsaWRlLXRvZ2dsZS9keW5hbWljLXNsaWRlLXRvZ2dsZS5jb21wb25lbnQnO1xuaW1wb3J0IHsgVGREeW5hbWljQ2hlY2tib3hDb21wb25lbnQgfSBmcm9tICcuLi9keW5hbWljLWVsZW1lbnRzL2R5bmFtaWMtY2hlY2tib3gvZHluYW1pYy1jaGVja2JveC5jb21wb25lbnQnO1xuaW1wb3J0IHsgVGREeW5hbWljU2xpZGVyQ29tcG9uZW50IH0gZnJvbSAnLi4vZHluYW1pYy1lbGVtZW50cy9keW5hbWljLXNsaWRlci9keW5hbWljLXNsaWRlci5jb21wb25lbnQnO1xuaW1wb3J0IHsgVGREeW5hbWljU2VsZWN0Q29tcG9uZW50IH0gZnJvbSAnLi4vZHluYW1pYy1lbGVtZW50cy9keW5hbWljLXNlbGVjdC9keW5hbWljLXNlbGVjdC5jb21wb25lbnQnO1xuaW1wb3J0IHsgVGREeW5hbWljRGF0ZXBpY2tlckNvbXBvbmVudCB9IGZyb20gJy4uL2R5bmFtaWMtZWxlbWVudHMvZHluYW1pYy1kYXRlcGlja2VyL2R5bmFtaWMtZGF0ZXBpY2tlci5jb21wb25lbnQnO1xuXG5leHBvcnQgZW51bSBUZER5bmFtaWNUeXBlIHtcbiAgVGV4dCA9ICd0ZXh0JyxcbiAgQm9vbGVhbiA9ICdib29sZWFuJyxcbiAgTnVtYmVyID0gJ251bWJlcicsXG4gIEFycmF5ID0gJ2FycmF5JyxcbiAgRGF0ZSA9ICdkYXRlJyxcbn1cblxuZXhwb3J0IGVudW0gVGREeW5hbWljRWxlbWVudCB7XG4gIElucHV0ID0gJ2lucHV0JyxcbiAgRGF0ZXBpY2tlciA9ICdkYXRlcGlja2VyJyxcbiAgUGFzc3dvcmQgPSAncGFzc3dvcmQnLFxuICBUZXh0YXJlYSA9ICd0ZXh0YXJlYScsXG4gIFNsaWRlciA9ICdzbGlkZXInLFxuICBTbGlkZVRvZ2dsZSA9ICdzbGlkZS10b2dnbGUnLFxuICBDaGVja2JveCA9ICdjaGVja2JveCcsXG4gIFNlbGVjdCA9ICdzZWxlY3QnLFxuICBGaWxlSW5wdXQgPSAnZmlsZS1pbnB1dCcsXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSVRkRHluYW1pY0VsZW1lbnRWYWxpZGF0b3Ige1xuICB2YWxpZGF0b3I6IFZhbGlkYXRvckZuO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIElUZER5bmFtaWNFbGVtZW50Q29uZmlnIHtcbiAgbGFiZWw/OiBzdHJpbmc7XG4gIG5hbWU6IHN0cmluZztcbiAgaGludD86IHN0cmluZztcbiAgdHlwZTogVGREeW5hbWljVHlwZSB8IFRkRHluYW1pY0VsZW1lbnQgfCBUeXBlPGFueT47XG4gIHJlcXVpcmVkPzogYm9vbGVhbjtcbiAgZGlzYWJsZWQ/OiBib29sZWFuO1xuICBtaW4/OiBhbnk7XG4gIG1heD86IGFueTtcbiAgbWluTGVuZ3RoPzogYW55O1xuICBtYXhMZW5ndGg/OiBhbnk7XG4gIHNlbGVjdGlvbnM/OiBzdHJpbmdbXSB8IHsgdmFsdWU6IGFueSwgbGFiZWw6IHN0cmluZyB9W107XG4gIG11bHRpcGxlPzogYm9vbGVhbjtcbiAgZGVmYXVsdD86IGFueTtcbiAgZmxleD86IG51bWJlcjtcbiAgdmFsaWRhdG9ycz86IElUZER5bmFtaWNFbGVtZW50VmFsaWRhdG9yW107XG59XG5cbmV4cG9ydCBjb25zdCBEWU5BTUlDX0VMRU1FTlRfTkFNRV9SRUdFWDogUmVnRXhwID0gL15bXjAtOV1bXlxcQF0qJC87XG5cbkBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBUZER5bmFtaWNGb3Jtc1NlcnZpY2Uge1xuXG4gIC8qKlxuICAgKiBNZXRob2QgdG8gdmFsaWRhdGUgaWYgdGhlIFtuYW1lXSBpcyBhIHByb3BlciBlbGVtZW50IG5hbWUuXG4gICAqIFRocm93cyBlcnJvciBpZiBuYW1lIGlzIG5vdCB2YWxpZC5cbiAgICovXG4gIHZhbGlkYXRlRHluYW1pY0VsZW1lbnROYW1lKG5hbWU6IHN0cmluZyk6IHZvaWQge1xuICAgIGlmICghRFlOQU1JQ19FTEVNRU5UX05BTUVfUkVHRVgudGVzdChuYW1lKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdEeW5hbWljIGVsZW1lbnQgbmFtZTogXCIke25hbWV9XCIgaXMgbm90IHZhbGlkLicpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIGNvbXBvbmVudCB0byBiZSByZW5kZXJlZCBkZXBlbmRpbmcgb24gW1RkRHluYW1pY0VsZW1lbnQgfCBUZER5bmFtaWNUeXBlXVxuICAgKiBUaHJvd3MgZXJyb3IgaWYgaXQgZG9lcyBub3QgZXhpc3RzIG9yIG5vdCBzdXBwb3J0ZWQuXG4gICAqL1xuICBnZXREeW5hbWljRWxlbWVudChlbGVtZW50OiBUZER5bmFtaWNFbGVtZW50IHwgVGREeW5hbWljVHlwZSk6IGFueSB7XG4gICAgc3dpdGNoIChlbGVtZW50KSB7XG4gICAgICBjYXNlIFRkRHluYW1pY1R5cGUuVGV4dDpcbiAgICAgIGNhc2UgVGREeW5hbWljVHlwZS5OdW1iZXI6XG4gICAgICBjYXNlIFRkRHluYW1pY0VsZW1lbnQuSW5wdXQ6XG4gICAgICBjYXNlIFRkRHluYW1pY0VsZW1lbnQuUGFzc3dvcmQ6XG4gICAgICAgIHJldHVybiBUZER5bmFtaWNJbnB1dENvbXBvbmVudDtcbiAgICAgIGNhc2UgVGREeW5hbWljRWxlbWVudC5UZXh0YXJlYTpcbiAgICAgICAgcmV0dXJuIFRkRHluYW1pY1RleHRhcmVhQ29tcG9uZW50O1xuICAgICAgY2FzZSBUZER5bmFtaWNUeXBlLkJvb2xlYW46XG4gICAgICBjYXNlIFRkRHluYW1pY0VsZW1lbnQuU2xpZGVUb2dnbGU6XG4gICAgICAgIHJldHVybiBUZER5bmFtaWNTbGlkZVRvZ2dsZUNvbXBvbmVudDtcbiAgICAgIGNhc2UgVGREeW5hbWljRWxlbWVudC5DaGVja2JveDpcbiAgICAgICAgcmV0dXJuIFRkRHluYW1pY0NoZWNrYm94Q29tcG9uZW50O1xuICAgICAgY2FzZSBUZER5bmFtaWNFbGVtZW50LlNsaWRlcjpcbiAgICAgICAgcmV0dXJuIFRkRHluYW1pY1NsaWRlckNvbXBvbmVudDtcbiAgICAgIGNhc2UgVGREeW5hbWljVHlwZS5BcnJheTpcbiAgICAgIGNhc2UgVGREeW5hbWljRWxlbWVudC5TZWxlY3Q6XG4gICAgICAgIHJldHVybiBUZER5bmFtaWNTZWxlY3RDb21wb25lbnQ7XG4gICAgICBjYXNlIFRkRHluYW1pY0VsZW1lbnQuRmlsZUlucHV0OlxuICAgICAgICByZXR1cm4gVGREeW5hbWljRmlsZUlucHV0Q29tcG9uZW50O1xuICAgICAgY2FzZSBUZER5bmFtaWNFbGVtZW50LkRhdGVwaWNrZXI6XG4gICAgICBjYXNlIFRkRHluYW1pY1R5cGUuRGF0ZTpcbiAgICAgICAgcmV0dXJuIFRkRHluYW1pY0RhdGVwaWNrZXJDb21wb25lbnQ7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm9yOiB0eXBlICR7ZWxlbWVudH0gZG9lcyBub3QgZXhpc3Qgb3Igbm90IHN1cHBvcnRlZC5gKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyBmb3JtIGNvbnRyb2wgZm9yIGVsZW1lbnQgZGVwZW5kaW5nIFtJVGREeW5hbWljRWxlbWVudENvbmZpZ10gcHJvcGVydGllcy5cbiAgICovXG4gIGNyZWF0ZUZvcm1Db250cm9sKGNvbmZpZzogSVRkRHluYW1pY0VsZW1lbnRDb25maWcpOiBGb3JtQ29udHJvbCB7XG4gICAgbGV0IHZhbGlkYXRvcjogVmFsaWRhdG9yRm4gPSB0aGlzLmNyZWF0ZVZhbGlkYXRvcnMoY29uZmlnKTtcbiAgICByZXR1cm4gbmV3IEZvcm1Db250cm9sKHsgdmFsdWU6IGNvbmZpZy5kZWZhdWx0LCBkaXNhYmxlZDogY29uZmlnLmRpc2FibGVkIH0sIHZhbGlkYXRvcik7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyBmb3JtIHZhbGlkYXRpb25kZXBlbmRpbmcgW0lUZER5bmFtaWNFbGVtZW50Q29uZmlnXSBwcm9wZXJ0aWVzLlxuICAgKi9cbiAgY3JlYXRlVmFsaWRhdG9ycyhjb25maWc6IElUZER5bmFtaWNFbGVtZW50Q29uZmlnKTogVmFsaWRhdG9yRm4ge1xuICAgIGxldCB2YWxpZGF0b3I6IFZhbGlkYXRvckZuO1xuICAgIGlmIChjb25maWcucmVxdWlyZWQpIHtcbiAgICAgIHZhbGlkYXRvciA9IFZhbGlkYXRvcnMucmVxdWlyZWQ7XG4gICAgfVxuICAgIGlmIChjb25maWcubWF4IHx8IGNvbmZpZy5tYXggPT09IDApIHtcbiAgICAgIHZhbGlkYXRvciA9IFZhbGlkYXRvcnMuY29tcG9zZShbdmFsaWRhdG9yLCBWYWxpZGF0b3JzLm1heChwYXJzZUZsb2F0KGNvbmZpZy5tYXgpKV0pO1xuICAgIH1cbiAgICBpZiAoY29uZmlnLm1pbiB8fCBjb25maWcubWluID09PSAwKSB7XG4gICAgICB2YWxpZGF0b3IgPSBWYWxpZGF0b3JzLmNvbXBvc2UoW3ZhbGlkYXRvciwgVmFsaWRhdG9ycy5taW4ocGFyc2VGbG9hdChjb25maWcubWluKSldKTtcbiAgICB9XG4gICAgaWYgKGNvbmZpZy5tYXhMZW5ndGggfHwgY29uZmlnLm1heExlbmd0aCA9PT0gMCkge1xuICAgICAgdmFsaWRhdG9yID0gVmFsaWRhdG9ycy5jb21wb3NlKFt2YWxpZGF0b3IsIFZhbGlkYXRvcnMubWF4TGVuZ3RoKHBhcnNlRmxvYXQoY29uZmlnLm1heExlbmd0aCkpXSk7XG4gICAgfVxuICAgIGlmIChjb25maWcubWluTGVuZ3RoIHx8IGNvbmZpZy5taW5MZW5ndGggPT09IDApIHtcbiAgICAgIHZhbGlkYXRvciA9IFZhbGlkYXRvcnMuY29tcG9zZShbdmFsaWRhdG9yLCBWYWxpZGF0b3JzLm1pbkxlbmd0aChwYXJzZUZsb2F0KGNvbmZpZy5taW5MZW5ndGgpKV0pO1xuICAgIH1cbiAgICAvLyBBZGQgcHJvdmlkZWQgY3VzdG9tIHZhbGlkYXRvcnMgdG8gdGhlIHZhbGlkYXRvciBmdW5jdGlvblxuICAgIGlmIChjb25maWcudmFsaWRhdG9ycykge1xuICAgICAgY29uZmlnLnZhbGlkYXRvcnMuZm9yRWFjaCgodmFsaWRhdG9yQ29uZmlnOiBJVGREeW5hbWljRWxlbWVudFZhbGlkYXRvcikgPT4ge1xuICAgICAgICB2YWxpZGF0b3IgPSBWYWxpZGF0b3JzLmNvbXBvc2UoW3ZhbGlkYXRvciwgdmFsaWRhdG9yQ29uZmlnLnZhbGlkYXRvcl0pO1xuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiB2YWxpZGF0b3I7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIERZTkFNSUNfRk9STVNfUFJPVklERVJfRkFDVE9SWShcbiAgcGFyZW50OiBUZER5bmFtaWNGb3Jtc1NlcnZpY2UpOiBUZER5bmFtaWNGb3Jtc1NlcnZpY2Uge1xuICByZXR1cm4gcGFyZW50IHx8IG5ldyBUZER5bmFtaWNGb3Jtc1NlcnZpY2UoKTtcbn1cblxuZXhwb3J0IGNvbnN0IERZTkFNSUNfRk9STVNfUFJPVklERVI6IFByb3ZpZGVyID0ge1xuICAvLyBJZiB0aGVyZSBpcyBhbHJlYWR5IGEgc2VydmljZSBhdmFpbGFibGUsIHVzZSB0aGF0LiBPdGhlcndpc2UsIHByb3ZpZGUgYSBuZXcgb25lLlxuICBwcm92aWRlOiBUZER5bmFtaWNGb3Jtc1NlcnZpY2UsXG4gIGRlcHM6IFtbbmV3IE9wdGlvbmFsKCksIG5ldyBTa2lwU2VsZigpLCBUZER5bmFtaWNGb3Jtc1NlcnZpY2VdXSxcbiAgdXNlRmFjdG9yeTogRFlOQU1JQ19GT1JNU19QUk9WSURFUl9GQUNUT1JZLFxufTtcbiJdfQ==